cmake_minimum_required(VERSION 3.0)
project(Glad)

message("")
message("==== Glad ====")

set(OpenGL_GL_PREFERENCE "GLVND")
find_package(OpenGL REQUIRED)

add_library(Glad STATIC "include/glad/glad.h" "src/glad.c")
target_include_directories(Glad PUBLIC "include")

target_link_libraries(Glad 
    PUBLIC ${OPENGL_LIBRARIES}
)

# Print Glad version
if(EXISTS "${CMAKE_CURRENT_SOURCE_DIR}/include/glad/glad.h")
  file(STRINGS "${CMAKE_CURRENT_SOURCE_DIR}/include/glad/glad.h" GLAD_VERSION_LINE REGEX "^[ \t]+OpenGL loader generated by glad [0-9.]*")
  string(REGEX REPLACE "^[ \t]+OpenGL loader generated by glad ([0-9.]*)(.*)" "\\1" GLAD_VERSION "${GLAD_VERSION_LINE}")
  message(STATUS "GLAD_VERSION: ${GLAD_VERSION}")
  unset(GLAD_VERSION_LINE)
  unset(GLAD_VERSION)
endif()
